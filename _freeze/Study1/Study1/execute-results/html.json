{
  "hash": "4bd10173a9432504c36500830991f161",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Exploring Sociodemographic and Health Associations in the NHANES 2017–March 2020 Dataset: Insights from Multivariable and Comparative Analyses\"\nauthor: \"Bosco Bakwatanisa\"\ndate: last-modified\nformat: \n html:\n    fig-responsive: true\n    fig-align: center\n    fig-width: 8\n    fig-height: 8\n    page-layout: full\n    embed-resources: true\n    number_sections: TRUE\n    date-format: iso\n---\n\n\n\n\n## 1. Setup and Data Ingest\n\n### 1.1. Loading R packages\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#load required R libraries\nlibrary(nhanesA)\nlibrary(forcats)\nlibrary(Hmisc)\nlibrary(boot)\nlibrary(ggplot2)\nlibrary(ggpubr)\nlibrary(kableExtra)\nlibrary(janitor)\nlibrary(naniar)\nlibrary(patchwork)\nlibrary(gridExtra)\nlibrary(broom.mixed)\nlibrary(Epi)\nlibrary(vcd)\nlibrary(xfun)\nlibrary(epitools)\nlibrary(tidyverse)\ntheme_set(theme_light())  \nknitr::opts_chunk$set(comment=NA)\n```\n:::\n\n\n\n\n## 2. Cleaning the Data\n\n### 2.1. Data preparation\n\nI downloaded the Blood Pressure data and Demographics data from 2017-March 2020 NHANES data\n\n\n<!--```{r echo=TRUE, warning=FALSE, message=FALSE}\n# pull in data from P_BPXO from NHANES and save it\n\nbp_raw <- nhanes('P_BPX') |> tibble()\ndemo_raw <- nhanes('P_DEMO') |> tibble()\nsaveRDS(demo_raw, file = \"data/P_DEMO.rds\")\nsaveRDS(bp_raw, file = \"data/P_BPXO.rds\")\n\n# Now that data are saved, I can just read in the tibble\n\nbp_raw <- readRDS(file = \"data/P_BPXO.rds\")\ndemo_raw <- readRDS(\"data/P_DEMO.rds\")\nDEMO <- demo_raw%>%\n  select(., SEQN,RIAGENDR,RIDAGEYR,DMDEDUC2,RIDRETH3 )\nBPX <- bp_raw%>%\n  select(., SEQN, BPXOSY1,BPXOSY2)\nAnalysis_1Data <- left_join(DEMO, BPX, by = \"SEQN\")\nBMX_raw <- nhanes(\"P_BMX\")|> tibble()   # Body measurements dataset\nsaveRDS(BMX_raw, file = \"data/P_BMX.rds\")\n# Merge datasets on SEQN (participant ID)\nsaveRDS(Analysis_1Data,file = 'data/AnalysisA.rds')\nBMX_raw<- readRDS(\"data/P_BMX.rds\")\nBMXBMI <- BMX_raw%>%select(SEQN,BMXBMI)\nAnalysisB_data <- left_join(Analysis_1Data, BMXBMI, by = \"SEQN\")\nsaveRDS(AnalysisB_data, file = \"data/AnalysisB_data.rds\")\n#Analysis C uses same dataset as above\n#analysisD data download\nSMQ_raw <- nhanes(\"P_SMQ\")\nAnalysisB_data <- readRDS('data/AnalysisB_data.rds')\nsmoke_data <- SMQ_raw%>% select(SEQN,SMQ020)\nAnalysisD_data <- left_join(AnalysisB_data, smoke_data, by = \"SEQN\")\nAnalysisData <- AnalysisD_data%>% filter( RIDAGEYR >=21 &  RIDAGEYR<= 79)\nanalysisTibble <- AnalysisData%>% select(SEQN, RIDAGEYR,RIAGENDR, BMXBMI,RIDRETH3,DMDEDUC2,SMQ020,BPXOSY1,BPXOSY2)%>% drop_na()%>%\n  filter(BPXOSY1 >0, BPXOSY2 > 0, BMXBMI >0, SMQ020 %in% c(\"Yes\",\"No\"), RIDRETH3 %in% c('Mexican American', 'Other Hispanic','Non-Hispanic White','Non-Hispanic Black','Non-Hispanic Asian'),\n         DMDEDUC2 %in% c('Less than 9th grade','9-11th grade (Includes 12th grade with no diploma)','High school graduate/GED or equivalent','Some college or AA degree','College graduate or above'))%>% \n  rename(Gender  =RIAGENDR,Age = RIDAGEYR, BMI =BMXBMI, Race =RIDRETH3, Education = DMDEDUC2, Smoking = SMQ020)%>% \n  mutate(Gender = ifelse(Gender==\"Male\",1,2),Race = factor(Race,levels = c(\"Mexican American\",\"Other Hispanic\",\"Non-Hispanic White\",\"Non-Hispanic Black\",\"Non-Hispanic Asian\"),\n                                                           labels = c(\"Mexican\",\"Hispanic\", \"White\",\"Black\", \"Asian\")), Smoking = ifelse(Smoking==\"Yes\",\"Smoker\",\"Non_Smoker\"),Obesity =  ifelse(BMI >=30, \"Obese\",\"Non_Obese\"),\n         Education = factor(\n           Education,\n           levels = c(\"Less than 9th grade\",\"9-11th grade (Includes 12th grade with no diploma)\", \"High school graduate/GED or equivalent\", \"Some college or AA degree\",\"College graduate or above\"),\n           labels = c( \"less_9th_grade\",\"9_12th_grade\", \"High_school\",\"Some_College\", \"College_graduate\" )))%>% mutate(Smoking = factor(Smoking, levels = c(\"Smoker\",\"Non_Smoker\")), Obesity = factor(Obesity, levels = c(\"Obese\",\"Non_Obese\")), Gender = factor(Gender, levels = c(1,2)))\n                                                                                             \nsaveRDS(analysisTibble, file = 'data/AnalysesData.rds')\n\n```\n-->\n#### 2. 1.1. Analysis A Data\n\nHere, I zeroed down to the Systolic Blood Pressure measurements for sessions 1 and 2 as the paired outcome variables for analysis A. This was co-selected with the SEQN columns just to ensure that systolic blood pressure is paired for each individual in the chosen population.\n\n::: {.cell}\n\n```{.r .cell-code}\nAnalysisData <- readRDS('data/AnalysesData.rds')\n analysisA_data <- AnalysisData%>% select(BPXOSY1,BPXOSY2)\nsaveRDS(analysisA_data, file = 'data/AnalysisA.rds')\n```\n:::\n\n#### 2.1.2. Analysis B Data\n\nHere I used already downloaded demographics and downloaded examination datasets (body measurement data) and then combined the two data sets for this analysis.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAnalysesData <- readRDS('data/AnalysesData.rds')\n# Select relevant variables for Analysis B\nanalysisB_data <-AnalysesData %>% \n  select(Gender, BMI)\n \nsaveRDS(analysisB_data, \"data/analysisB.rds\")\n```\n:::\n\n\n\n\n#### 2.1.3. Analysis C Data\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAnalysesData <- readRDS('data/AnalysesData.rds')\n\nanalysisC_data <- AnalysesData%>%\n  select(Race,BMI)\nlength(unique(analysisC_data$BMI))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 429\n```\n\n\n:::\n\n```{.r .cell-code}\nsaveRDS(analysisC_data, 'data/analysisC.rds')\n```\n:::\n\n\n\n\n#### 2.1.4. Analysis D Data\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAnalysesData <- readRDS('data/AnalysesData.rds')\nanalysisD_data <- AnalysesData %>% \n  select(Smoking,Obesity) \n  \nsaveRDS(analysisD_data, 'data/analysisD.rds')\n```\n:::\n\n\n\n\n#### 2.1.5 Analysis E Data cleaning, filtering and re-coding\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAnalysesData <- readRDS('data/AnalysesData.rds')\nanalysisE_data <- AnalysesData %>%\n  select(Race, Education)\nsaveRDS(analysisE_data, 'data/analysisE.rds')\n```\n:::\n\n\n\n\n## 3. Codebook and Data Description\n\n### 3.1. Coodbook\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvariable_description <- tibble::tribble(\n  ~Variable_Name, ~Role_in_Analysis,~Type, ~Original_Code, \n  \"SEQN\",  \"ID\",   \"Quant\",   \" Respondent sequence number\",\n  \"Gender\",  \"Analysis B Variable\", \"Binary\", \"RIAGENDR\",\n  \"RIDAGEYR\", \"Used to select Adult persons aged 21-79 years\",\"Quant\",\"RIDAGEYR\",   \"Education\",   \"Analysis E variable\",  \"X-cat\" ,  \"DMDEDUC2\",\n  \"Race/Ethnicity\", \"Analysis E variable\",  \"X-cat\", \"RIDRETH3 \", \n  \"BPXOSY1 \",   \"Analysis A-variable\",\"Quant\", \"BPXOSY1\",\n  \"BPXOSY2\",\"Analysis A-variable\",  \"Quant\", \"BPXOSY2\",\n  \"BMI\",\"Analysis variable\", \"Quant\", \"BMXBMI\",\"Smoking\", \"Analysis D-variable\",  \"Binary\", \"SMQ020\",\"Obesity\", \"Analysis Variable\", \"Binary\",\"N/A\")\nvariable_description |> kbl() |> kable_styling(bootstrap_options = \"striped\", full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Variable_Name </th>\n   <th style=\"text-align:left;\"> Role_in_Analysis </th>\n   <th style=\"text-align:left;\"> Type </th>\n   <th style=\"text-align:left;\"> Original_Code </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> SEQN </td>\n   <td style=\"text-align:left;\"> ID </td>\n   <td style=\"text-align:left;\"> Quant </td>\n   <td style=\"text-align:left;\"> Respondent sequence number </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gender </td>\n   <td style=\"text-align:left;\"> Analysis B Variable </td>\n   <td style=\"text-align:left;\"> Binary </td>\n   <td style=\"text-align:left;\"> RIAGENDR </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> RIDAGEYR </td>\n   <td style=\"text-align:left;\"> Used to select Adult persons aged 21-79 years </td>\n   <td style=\"text-align:left;\"> Quant </td>\n   <td style=\"text-align:left;\"> RIDAGEYR </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Education </td>\n   <td style=\"text-align:left;\"> Analysis E variable </td>\n   <td style=\"text-align:left;\"> X-cat </td>\n   <td style=\"text-align:left;\"> DMDEDUC2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Race/Ethnicity </td>\n   <td style=\"text-align:left;\"> Analysis E variable </td>\n   <td style=\"text-align:left;\"> X-cat </td>\n   <td style=\"text-align:left;\"> RIDRETH3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> BPXOSY1 </td>\n   <td style=\"text-align:left;\"> Analysis A-variable </td>\n   <td style=\"text-align:left;\"> Quant </td>\n   <td style=\"text-align:left;\"> BPXOSY1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> BPXOSY2 </td>\n   <td style=\"text-align:left;\"> Analysis A-variable </td>\n   <td style=\"text-align:left;\"> Quant </td>\n   <td style=\"text-align:left;\"> BPXOSY2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> BMI </td>\n   <td style=\"text-align:left;\"> Analysis variable </td>\n   <td style=\"text-align:left;\"> Quant </td>\n   <td style=\"text-align:left;\"> BMXBMI </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Smoking </td>\n   <td style=\"text-align:left;\"> Analysis D-variable </td>\n   <td style=\"text-align:left;\"> Binary </td>\n   <td style=\"text-align:left;\"> SMQ020 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Obesity </td>\n   <td style=\"text-align:left;\"> Analysis Variable </td>\n   <td style=\"text-align:left;\"> Binary </td>\n   <td style=\"text-align:left;\"> N/A </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n### 3.2. Analytic Tibble\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAnalysesData <- readRDS('data/AnalysesData.rds')\ndescribe(AnalysesData[,-1])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysesData[, -1] \n\n 9  Variables      6669  Observations\n--------------------------------------------------------------------------------\nAge \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n    6669        0       59        1    49.61    18.39       24       27 \n     .25      .50      .75      .90      .95 \n      36       51       63       70       74 \n\nlowest : 21 22 23 24 25, highest: 75 76 77 78 79\n--------------------------------------------------------------------------------\nGender \n       n  missing distinct \n    6669        0        2 \n                      \nValue          1     2\nFrequency   3262  3407\nProportion 0.489 0.511\n--------------------------------------------------------------------------------\nBMI \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n    6669        0      429        1    30.22    8.133     20.4     21.9 \n     .25      .50      .75      .90      .95 \n    25.0     28.9     34.0     40.1     44.3 \n\nlowest : 14.6 14.8 14.9 15   15.1, highest: 72.9 74.8 75.7 78.6 80.6\n--------------------------------------------------------------------------------\nRace \n       n  missing distinct \n    6669        0        5 \n                                                       \nValue       Mexican Hispanic    White    Black    Asian\nFrequency       801      733     2323     1953      859\nProportion    0.120    0.110    0.348    0.293    0.129\n--------------------------------------------------------------------------------\nEducation \n       n  missing distinct \n    6669        0        5 \n                                                                              \nValue        less_9th_grade     9_12th_grade      High_school     Some_College\nFrequency               460              702             1611             2182\nProportion            0.069            0.105            0.242            0.327\n                           \nValue      College_graduate\nFrequency              1714\nProportion            0.257\n--------------------------------------------------------------------------------\nSmoking \n       n  missing distinct \n    6669        0        2 \n                                \nValue          Smoker Non_Smoker\nFrequency        2755       3914\nProportion      0.413      0.587\n--------------------------------------------------------------------------------\nBPXOSY1 \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n    6669        0      134        1    124.3    21.15       98      102 \n     .25      .50      .75      .90      .95 \n     111      122      135      150      160 \n\nlowest :  66  76  78  80  81, highest: 210 213 217 219 220\n--------------------------------------------------------------------------------\nBPXOSY2 \n       n  missing distinct     Info     Mean      Gmd      .05      .10 \n    6669        0      135        1      124    20.99       98      102 \n     .25      .50      .75      .90      .95 \n     111      121      135      149      159 \n\nlowest :  69  72  73  76  77, highest: 214 215 218 219 222\n--------------------------------------------------------------------------------\nObesity \n       n  missing distinct \n    6669        0        2 \n                              \nValue          Obese Non_Obese\nFrequency       2928      3741\nProportion     0.439     0.561\n--------------------------------------------------------------------------------\n```\n\n\n:::\n:::\n\n\n\n\n## **4. Analysis A**\n\n### 4.1. Research Question\n\n#### 4.1.1.Problem statement\n\nResearch has shown that systolic blood pressure (SBP) is a critical measure for diagnosing hypertension and assessing cardiovascular risk. Repeated measurements are usually taken to improve accuracy and account for variability caused by circumstances such as white coat hypertension (temporary rise in blood pressure due to clinical environment), measurement error or technical variability and physiological changes during the measurement process. And therefore understanding the consistency or difference between successive SBP measurements can inform the protocol used for measuring blood pressure by highlighting any systematic bias in measurements and also help in identifying persons who at a risk of developing hypertension.\n\n#### **4.1.2. Research Question:**\n\nIs there a significant difference between the first and second oscillometric systolic blood pressure measurements (BPXOSY1 and BPXOSY2) in individuals as recorded in the NHANES 2017–March 2020 dataset?.\n\n#### 4.1.3. Hypotheses\n\n##### 4.1.3.1 Null Hypothesis $({H_o})$\n\nThere is no significant difference between the mean of the first systolic blood pressure measurement (BPXOSY1) and the second systolic blood pressure measurement (BPXOSY2)\n\n$${H_o} : {μ_{BPXOSY1} = μ_{BPXOSY2}}$$\n\n##### 4.1.3.2. Alternative Hypothesis\n\nThere is a significant difference between the mean of the first systolic blood pressure measurement (BPXOSY1) and the second systolic blood pressure measurement (BPXOSY2).\n\n$${H_A} : {μ_{BPXOSY1}  \\neq  μ_{BPXOSY2}}$$\n\n### 4.2. Describing The Data\n\nRefer to the codebook in section 3 for the description of the variables (BPXOSY1 and BPXOSY2) used in this analysis. Here, I ran a data exploratory analysis and described the distribution of each of the two variables by looking at their statistical summaries (mean, median, sd, interquartile range, minimum, and maximum) and continued to provide some visualization graphics including histogram, boxplots, and Q-Q plots to provide a better understanding of the data.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanalysisA_data <- readRDS('data/AnalysisA.rds')# read the\nsummary(analysisA_data %>% select(BPXOSY1,BPXOSY2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    BPXOSY1         BPXOSY2   \n Min.   : 66.0   Min.   : 69  \n 1st Qu.:111.0   1st Qu.:111  \n Median :122.0   Median :121  \n Mean   :124.3   Mean   :124  \n 3rd Qu.:135.0   3rd Qu.:135  \n Max.   :220.0   Max.   :222  \n```\n\n\n:::\n:::\n\n\n\n\n#### **4.2.1. Visualization**\n\nIn order to have a clear understanding of the data variables in terms data distribution and checking for normality, I used the Histogram, Boxplot, and the Q-Q plot to display the data.\n\n##### **4.2.1.1. Histogram and Boxplot**\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Study1_files/figure-html/unnamed-chunk-9-1.png){width=768}\n:::\n:::\n\n\n\n\nFrom the visualizations above, the data\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <-ggplot(analysisA_data, aes(x = log(BPXOSY1))) +\n  geom_histogram(fill = \"slateblue\", col = \"white\",\n                 bins = 20) + \n  labs(title = \"LogTransformed-Systolic BP First Reading in `NHANES`\",\n       x = \"log(Systolic BP First Reading (mm Hg))\")+\n   theme_classic(base_size = 10) +\n  theme(\n        axis.text = element_text(face = \"bold\",size = 10),\n        axis.title.y = element_text(face = \"bold\", size = 10),\n        axis.title.x = element_text(face = \"bold\", size = 10),\n        plot.title = element_text(face = \"bold\", hjust = 0.5, size = 12))\n\np2 <-ggplot(analysisA_data, aes(x = log(BPXOSY2))) +\n  geom_histogram(fill = \"orange\", col = \"white\",\n                 bins = 20) + \n  labs(title = \"Systolic BP Second Reading in `NHANES`\",\n       x = \"log(Systolic BP Second Reading(mm Hg))\")+\n   theme_classic(base_size = 10) +\n  theme(\n        axis.text = element_text(face = \"bold\",size = 10),\n        axis.title.y = element_text(face = \"bold\", size = 10),\n        axis.title.x = element_text(face = \"bold\", size = 10),\n        plot.title = element_text(face = \"bold\", hjust = 0.5, size = 12))\n\n\np3 <-ggplot(analysisA_data, aes(x = \"\", y = log(BPXOSY1))) +\n  geom_boxplot(fill = \"slateblue\", outlier.size = 2,\n               outlier.color = \"slateblue\") +\n  #coord_flip() + \n  labs(y = \"log(Systolic BP First Reading (mm Hg))\")+\n   theme_classic(base_size = 10) +\n  theme(\n        axis.text = element_text(face = \"bold\",size = 10),\n        axis.title.y = element_text(face = \"bold\", size = 10),\n        axis.title.x = element_text(face = \"bold\", size = 10),\n        plot.title = element_text(face = \"bold\", hjust = 0.5, size = 12))\n     \n\np4 <-ggplot(analysisA_data, aes(x = \"\", y = log(BPXOSY2)))+\n  geom_boxplot(fill = \"orange\", outlier.size = 2,\n               outlier.color = \"orange\") +\n  #coord_flip() + \n  labs(y = \"log(Systolic BP Second Reading(mm Hg))\")+\n   theme_classic(base_size = 10) +\n  theme(\n        axis.text = element_text(face = \"bold\",size = 10),\n        axis.title.y = element_text(face = \"bold\", size = 10),\n        axis.title.x = element_text(face = \"bold\", size = 10),\n        plot.title = element_text(face = \"bold\", hjust = 0.5, size = 12))\n       \np1 +p2 + p3 + p4\n```\n\n::: {.cell-output-display}\n![](Study1_files/figure-html/unnamed-chunk-10-1.png){width=768}\n:::\n\n```{.r .cell-code}\nggsave(\"LogTransHistogram_and_Boxplots.png\")\n```\n:::\n\n\n\n\n##### 4.2.1.2. Q-Q Plot\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <-ggplot(analysisA_data, aes(sample = log(BPXOSY1))) +\n  geom_qq(col = \"slateblue\") + \n  geom_qq_line(col = \"magenta\") + \n  theme(aspect.ratio = 1) + \n  labs(title = \"Normal Q-Q: NHANES log(BPXOSY1)\")+\n   theme_classic(base_size = 10) +\n  theme(\n        axis.text = element_text(face = \"bold\",size = 10),\n        axis.title.y = element_text(face = \"bold\", size = 10),\n        axis.title.x = element_text(face = \"bold\", size = 10),\n        plot.title = element_text(face = \"bold\", hjust = 0.5, size = 12))\n\np2 <-ggplot(analysisA_data, aes(sample = log(BPXOSY2))) +\n  geom_qq(col = \"orange\") + \n  geom_qq_line(col = \"black\") + \n  theme(aspect.ratio = 1) + \n  labs(title = \"Normal Q-Q: NHANES log(BPXOSY2)\")+ theme_classic(base_size = 10) +\n  theme(\n        axis.text = element_text(face = \"bold\",size = 10),\n        axis.title.y = element_text(face = \"bold\", size = 10),\n        axis.title.x = element_text(face = \"bold\", size = 10),\n        plot.title = element_text(face = \"bold\", hjust = 0.5, size = 12))\n      \np1+p2\n```\n\n::: {.cell-output-display}\n![](Study1_files/figure-html/unnamed-chunk-11-1.png){width=768}\n:::\n\n```{.r .cell-code}\nggsave(\"Q-QPlots_for_systolic_blood_pressure.png\")\n```\n:::\n\n\n\n\nFrom the Q-Q plot we see that our data is still right skewed even after log-transformation and therefore does not satisfy the normality requirements and hence I will apply non-parametric methods to compare the paired means\n\n##### 4.2.1.3 Scatter Plot Paired Sample Box plots\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Scatter plot of paired data\np1 <-ggplot(analysisA_data, aes(x = log(BPXOSY1), y = log(BPXOSY2))) +\n  geom_point(alpha = 0.6) +\n  geom_abline(intercept = 0, slope = 1, color = \"red\", linetype = \"dashed\") +\n  labs(title = \"SBP(1st Reading vs 2nd Reading)\",\n       x = \"BPXOSY1 (First Reading)\", y = \"BPXOSY2 (Second Reading)\") +\n  theme_classic(base_size = 12) +\n  theme(\n        axis.text = element_text(face = \"bold\",size = 9),\n        axis.title.y = element_text(face = \"bold\", size = 9),\n        axis.title.x = element_text(face = \"bold\", size = 9),\n        plot.title = element_text(face = \"bold\", hjust = 0.5, size = 10))\n     \n\n# Paired boxplot\np2 <-analysisA_data %>% mutate(log_sbp1 = log(BPXOSY1), log_sbp2 = log(BPXOSY2))%>%\n  pivot_longer(cols = c(log_sbp1, log_sbp2), names_to = \"ReadingSession\", values_to = \"SystolicBloodPressure\") %>%\n ggplot(aes(x = ReadingSession, y = SystolicBloodPressure, fill = ReadingSession)) +\n  geom_boxplot() +\n  labs(title = \"Distribution of Blood Pressure (Paired Sessions)\",\n       x = \"Reading-Session\", y = \"Blood Pressure (mmHg)\") +\n   theme_classic(base_size = 10) +\n  theme(legend.position = \"left\",\n        axis.text = element_text(face = \"bold\",size = 10),\n        axis.title.y = element_text(face = \"bold\", size = 10),\n        axis.title.x = element_text(face = \"bold\", size = 10),\n        plot.title = element_text(face = \"bold\", hjust = 0.5, size = 10))\n\np1 + p2\n```\n\n::: {.cell-output-display}\n![](Study1_files/figure-html/unnamed-chunk-12-1.png){width=768}\n:::\n\n```{.r .cell-code}\nggsave(\"scatter plot_bp_sessions.png\")\nggsave(\"Boxplot_Blood_Pressure_Sessions.png\")\nwrite.csv(analysisA_data, \"data/Paired_Systolic_BP_data.csv\")\n```\n:::\n\n\n\n\n### **4.3. Main Analysis**\n\nHere, I used Wilcoxon signed-rank sum test to compare the means of the systolic blood pressure between the two sessions since the data did not meet the normality requirements. Additionally, I used a bootstrap procedure to calculate a confidence interval for the mean difference.\n\n#### **4.3.1. Wilcoxon Signed-Rank Test**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Perform Wilcoxon signed-rank test\nwilcox_result <- wilcox.test(log(analysisA_data$BPXOSY1), log(analysisA_data$BPXOSY2), paired = TRUE)\nprint(wilcox_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon signed rank test with continuity correction\n\ndata:  log(analysisA_data$BPXOSY1) and log(analysisA_data$BPXOSY2)\nV = 9810263, p-value = 0.004012\nalternative hypothesis: true location shift is not equal to 0\n```\n\n\n:::\n:::\n\n\n\n\n#### 4.3.2. Bootstrap Method\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define bootstrap function\nbootstrap_diff <- function(data, indices) {\n  sample_data <- data[indices, ]\n  mean(log(sample_data$BPXOSY1) - log(sample_data$BPXOSY2))\n}\n# Run bootstrap\nset.seed(123)\nboot_result <- boot(data = analysisA_data, statistic = bootstrap_diff, R = 1000)\n\n# Confidence interval\nboot_ci <- boot.ci(boot_result, type = \"perc\")\nprint(boot_ci)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nBOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS\nBased on 1000 bootstrap replicates\n\nCALL : \nboot.ci(boot.out = boot_result, type = \"perc\")\n\nIntervals : \nLevel     Percentile     \n95%   ( 0.0005,  0.0028 )  \nCalculations and Intervals on Original Scale\n```\n\n\n:::\n:::\n\n\n\n\n### **4.4. Conclusions**\n\nFrom the results of the Wilcoxon signed rank, We observe that The p-value is very small (0.004), which is far below the common significance level (α=0.05), which implies that the true median difference between Systolic blood pressure values for the 2 oscillometric readings is not equal to zero. And hence there is a statistically significant difference in the paired samples (BPXOSY1 and BPXOSY2). The bootstrap analysis further confirms that there is a significant difference between the paired samples. The mean difference is estimated to be between 0.0005 and 0.0028 with 95% confidence, which is above zero. This supports the conclusion that the two paired systolic blood pressure are statistically different.\n\n## 5. Analysis B\n\n### 5.1. Question\n\n#### 5.1.1. Problem Statement\n\nBody Mass Index (BMI) is a widely used indicator for assessing body fat based on height and weight. Gender differences in BMI may arise due to biological, hormonal, and societal factors influencing body composition, metabolism, lifestyle behaviors among others. Understanding how BMI varies with gender within a population may provide us with insights on how this association may influence the gender based health outcomes within the United States population.\n\n#### 5.1.2. Research Question: Is there any association between Body Mass Index and Gender?\n\n#### 5.1.3. Hypotheses\n\n##### 5.1.3.1. Null Hypothesis $({H_o})$\n\nThere is no association between Body Mass Index (BMI) and Gender in the United States population. The mean BMI of males is equal to the mean BMI for females; $${H_o} : {μ_{MaleBMI} = μ_{FemaleBMI}}$$\n\n##### 5.1.3.2. Alternative Hypothesis $({H_A})$:\n\nThere is an association between BMI and Gender in the United States population. The mean BMI for males is not equal to the mean BMI for female; $${H_A} : {μ_{MaleBMI}  \\neq  μ_{FemaleBMI}}$$\n\n### 5.2. Describing The Data\n\nRefer to the codebook in section 3 for the description of the variables (BMI) and Gender) used in this analysis. Here, I ran a data exploratory analysis and described the distribution of each of the two variables by looking at their statistical summaries (mean, median, sd, interquartile range, minimum, and maximum) and continued to provide some visualization graphics including histogram, boxplots, and Q-Q plots to provide a better understanding of the data.\n\n#### 5.2.1. Data summaries for the chosen variables for Analysis B\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanalysisB_data <- readRDS(\"data/analysisB.rds\")\nanalysisB_data %>%\n  group_by(Gender) %>%\n  summarise(\n    Mean_BMI = mean(BMI),\n    SD_BMI = sd(BMI),\n    IQR_BMI = IQR(BMI),\n    n = n()\n  )%>% kable(digits = 3)%>% kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Gender </th>\n   <th style=\"text-align:right;\"> Mean_BMI </th>\n   <th style=\"text-align:right;\"> SD_BMI </th>\n   <th style=\"text-align:right;\"> IQR_BMI </th>\n   <th style=\"text-align:right;\"> n </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 29.547 </td>\n   <td style=\"text-align:right;\"> 6.503 </td>\n   <td style=\"text-align:right;\"> 7.8 </td>\n   <td style=\"text-align:right;\"> 3262 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 30.867 </td>\n   <td style=\"text-align:right;\"> 8.395 </td>\n   <td style=\"text-align:right;\"> 10.5 </td>\n   <td style=\"text-align:right;\"> 3407 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n#### **5.2.2. Visualization of the data distribution**\n\n##### 5.6.1 Boxplot, Histogram, Density plot, and Q-Q Plot\n\nHere, I use a histogram, Q-Q plot, Boxplot, and the density plot to visualize the data distribution and assessment for normality.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <-ggplot(analysisB_data, aes(x = BMI)) +\n  geom_histogram(fill = \"slateblue\", col = \"white\",\n                 bins = 20) + \n  labs(title = \"BMI Distribution in `NHANES`\",\n       x = \"Body Mass Index\")+\n  theme_classic(base_size = 10) +\n  theme(legend.position = \"left\",\n        axis.text = element_text(face = \"bold\",size = 10),\n        axis.title.y = element_text(face = \"bold\", size = 10),\n        axis.title.x = element_text(face = \"bold\", size = 10),\n        plot.title = element_text(face = \"bold\", hjust = 0.5, size = 10))\n\np2 <- ggplot(analysisB_data, aes(sample = BMI)) +\n  geom_qq(col = \"slateblue\") + \n  geom_qq_line(col = \"magenta\") + \n  theme(aspect.ratio = 1) + \n  labs(title = \"Normal Q-Q: NHANES BMI\")+\n  theme_classic(base_size = 10) +\n  theme(legend.position = \"none\",\n        axis.text = element_text(face = \"bold\",size = 10),\n        axis.title.y = element_text(face = \"bold\", size = 10),\n        axis.title.x = element_text(face = \"bold\", size = 10),\n        plot.title = element_text(face = \"bold\", hjust = 0.5, size = 10))\n#Boxplot\np3 <-ggplot(analysisB_data, aes(x = Gender, y = BMI, fill = Gender)) +\n  geom_boxplot() + coord_flip()+\n  labs(title = \"Comparison of BMI by Gender\",\n       x = \"Gender\",\n       y = \"Body Mass Index (BMI)\") +\ntheme_classic(base_size = 10) +\n  theme(legend.position = \"left\",\n        axis.text = element_text(face = \"bold\",size = 10),\n        axis.title.y = element_text(face = \"bold\", size = 10),\n        axis.title.x = element_text(face = \"bold\", size = 10),\n        plot.title = element_text(face = \"bold\", hjust = 0.5, size = 12))\n#density plot\np4 <-ggplot(analysisB_data, aes(x = BMI, fill = Gender)) +\n  geom_density(alpha = 0.5) +\n  labs(title = \"BMI Distribution by Gender\",\n       x = \"Body Mass Index (BMI)\",\n       y = \"Density\") +\n theme_classic(base_size = 10) +\n  theme(legend.position = \"left\",\n        axis.text = element_text(face = \"bold\",size = 10),\n        axis.title.y = element_text(face = \"bold\", size = 10),\n        axis.title.x = element_text(face = \"bold\", size = 10),\n        plot.title = element_text(face = \"bold\", hjust = 0.5, size = 12))\n       \np1 +p2 +p3 +p4\n```\n\n::: {.cell-output-display}\n![](Study1_files/figure-html/unnamed-chunk-16-1.png){width=768}\n:::\n:::\n\n\n\n\n### 5.3. Main Analysis\n\nFrom the histogram and the Q-Q Normal plot, we observe that Body Mass index is right skewed and hence does not satisfy the normality requirement and hence in the subsequent analyses, I will use non parametric methods such as Wilcoxon rank-sum test and Bootstrap for calculating the confidence intervals.\n\n#### **5.3.1. Wilcoxon Rank-Sum Test**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(112724)\n#perform Wilcoxon Rank-sum test\nwilcox_test = wilcox.test(BMI ~ Gender, data = analysisB_data)\nglance(wilcox_test)%>% kable(digits = 3)%>% kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> alternative </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 5186376 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:left;\"> Wilcoxon rank sum test with continuity correction </td>\n   <td style=\"text-align:left;\"> two.sided </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n#### **5.3.2. Using Bootstrap Confidence Interval**\n\nI created function to use to compute the mean difference using the bootstrap method\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Define a bootstrap function\nbootstrap_mean_diff <- function(data, indices){\n  sample_data <- data[indices,]\n  mean(sample_data$BMI[sample_data$Gender==\"1\"])- mean(sample_data$BMI[sample_data$Gender==\"2\"])\n  \n}\n```\n:::\n\n\n\n\nRunning the bootstrap to compute the 90% confidence intervals for the independent sample mean difference.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# the bootstrap\nset.seed(2024)\nboot_result <- boot(data = analysisB_data, statistic = bootstrap_mean_diff, R =1000)\nboot_ci = boot.ci(boot_result, type = \"perc\", conf = 0.90)\nprint(boot_ci)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nBOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS\nBased on 1000 bootstrap replicates\n\nCALL : \nboot.ci(boot.out = boot_result, conf = 0.9, type = \"perc\")\n\nIntervals : \nLevel     Percentile     \n90%   (-1.607, -1.012 )  \nCalculations and Intervals on Original Scale\n```\n\n\n:::\n:::\n\n\n\n\n#### **5.3.3. Visualize the Results**\n\nI used the Boxplot/Violin plot to display the mean difference for better comparison\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n  ggplot(analysisB_data, aes(x = Gender, y = BMI, fill = Gender)) +\n  geom_violin(trim = FALSE, alpha = 0.4, color = \"coral\", lwd = 0.5) + \n  geom_boxplot(width = 0.3, outlier.shape = NA, alpha = 0.7, color = \"gray20\") + \n  stat_summary(fun = mean, geom = \"point\", shape = 23, size = 4, color = \"black\", fill = \"yellow\") +\n  stat_summary(fun = mean, geom = \"errorbar\", aes(ymax = ..y.., ymin = ..y..), width = 0.3, color = \"black\")+   \n    coord_flip() +\n  labs(title = \"Comparison of BMI by Gender\",\n       caption = \"Data Source: NHANES 2017-March 2020\",\n       x = \"Gender\", \n       y = \"Body Mass Index (BMI)\") +\n  theme_classic(base_size = 10) +\n  theme(legend.position = \"none\",\n        axis.text = element_text(face = \"bold\",size = 12),\n        axis.title.y = element_text(face = \"bold\", size = 12),\n        axis.title.x = element_text(face = \"bold\", size = 12),\n        plot.title = element_text(face = \"bold\", hjust = 0.5, size = 14),\n        plot.subtitle = element_text(hjust = 0.5,size = 12)) +\n  scale_fill_brewer(palette = \"Paired\")\n```\n\n::: {.cell-output-display}\n![](Study1_files/figure-html/unnamed-chunk-20-1.png){width=768}\n:::\n:::\n\n\n\n\n### **5.4. Conclusions**\n\nThe mean BMI for males was 29.571(sd = 6.631), and the mean BMI for females was 30.858 (sd = 8.493). The Wilcoxon rank-sum test indicated that there is a significant difference between mean BM1 between males and females (p \\<0.05). Bootstrap resampling provided a confidence interval of \\[-1.607, -1.012\\], since the confidence bounds lie below 0 and are both negative indicate that the male group has a significantly lower mean than the female group.\n\n## 6. Analysis D\n\n### 6.1. Question\n\n#### 6.1.1. Problem Statement\n\nSmoking and obesity are two significant risk factors for numerous chronic diseases, including cardiovascular diseases, diabetes, and certain cancers. Investigating the relationship between these two factors is essential to understand whether smoking status (current smoker vs. non-smoker) is associated with obesity status (obese vs. non-obese). By dividing the population into four distinct groups based on these binary categorical variables, we aim to assess the interaction between smoking and obesity and evaluate any potential public health implications.\n\n#### 6.1.2. Research Question\n\nIs there a significant association between smoking status and obesity status in the US population, as represented by the NHANES 2017-March 2020 data?\n\n#### 6.1.3. Hypotheses\n\n##### 6.1.3.1 Null Hypothesis $({H_o})$\n\nThere is no association between smoking status (current smoker vs. non-smoker) and obesity status (obese vs. non-obese) in the population. The observed frequencies in the 2x2 table are consistent with the assumption of independence.\n\n##### 6.1.3.2. Alternative hypothesis $({H_A})$\n\nThere is a significant association between smoking status (current smoker vs. non-smoker) and obesity status (obese vs. non-obese) in the population. The observed frequencies in the 2x2 table deviate significantly from what is expected under the assumption of independence.\n\n### 6.2. Describing The Data\n\nRefer to the codebook in section 3 for the description of the variable SMQ020 and Body Mass Index (BMXBMI). However, for this analysis BMI was converted into a binary variable with people having BMI \\> 30 considered to be obese and those with BMI \\< 30 considered non-obese and as earlier described smoking was binarized into non-smoker and smoker. Here, I ran a data exploratory analysis and described the distribution of each of the two variables by looking at their statistical summaries, 2x2 table and continued to provide some visualization graphics including bar plot, mosaic plot, and boxplots to provide a better understanding of the data.\n\n#### **6.2.1. Data Summaries**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanalysisD_data <- readRDS('data/analysisD.rds')\nanalysisD_data |>\ntabyl(Smoking,Obesity) |>\nadorn_totals(\"row\") |>\nadorn_percentages(\"row\") |>\nadorn_pct_formatting() |>\nadorn_ns(position = \"front\")%>% kable()%>%kable_styling(bootstrap_options = \"striped\", full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Smoking </th>\n   <th style=\"text-align:left;\"> Obese </th>\n   <th style=\"text-align:left;\"> Non_Obese </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Smoker </td>\n   <td style=\"text-align:left;\"> 1,233 (44.8%) </td>\n   <td style=\"text-align:left;\"> 1,522 (55.2%) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Non_Smoker </td>\n   <td style=\"text-align:left;\"> 1,695 (43.3%) </td>\n   <td style=\"text-align:left;\"> 2,219 (56.7%) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Total </td>\n   <td style=\"text-align:left;\"> 2,928 (43.9%) </td>\n   <td style=\"text-align:left;\"> 3,741 (56.1%) </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n#### **6.2.2. Data Visualization**\n\n##### 6.2.2.1. Bar plot\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanalysisD_data <- readRDS(\"data/analysisD.rds\")\nggplot(analysisD_data, aes(x = Smoking, fill = Obesity))+\n  geom_bar(position = \"dodge\")+\n  labs(\n    title = \"Smoking Status vs. Obesity\",\n    x = \"Smoking Status\",\n    y = \"Count\",\n    fill = \"Obesity\"\n  )+\n  theme_classic(base_size = 10) +\n  theme(legend.position = \"right\",\n        axis.title.y = element_text(face = \"bold\", size = 12),\n        axis.text = element_text(face =\"bold\", size = 12),\n        axis.title.x = element_text(face = \"bold\", size = 12),\n        plot.title = element_text(face = \"bold\", hjust = 0.5, size =14))\n```\n\n::: {.cell-output-display}\n![](Study1_files/figure-html/unnamed-chunk-22-1.png){width=768}\n:::\n:::\n\n\n\n\nThe analysis examined the association between smoking status (smoker vs. non-smoker) and obesity (obese vs. non-obese) using NHANES 2017-March 2020 data. The contingency table revealed a total of2755 smokers and 3914 non-smokers, 2928 obese people and 3741 non-obese people.\n\n##### **6.2.2.2. Mosaicplot from Contingency Table**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncontigency_table <- table(analysisD_data$Smoking,analysisD_data$Obesity)\nmosaicplot(\n  contigency_table,\n  main =\"Mosaic Plot of Smoking and Obesity\", color = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](Study1_files/figure-html/unnamed-chunk-23-1.png){width=768}\n:::\n:::\n\n\n\n\nNow, it’s helpful to show our 2 x 2 table. We see there were 1,233 (44.8%) of obese smokers among 2755 smokers and 1948 ( 43.3%) obese people among 3914 non-smokers.\n\n### 6.3. Main Analysis\n\n#### 6.3.1. Chi-square test\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#contigency_table <- analysisD_data %>% tabyl(Smoking, Obesity)\nchiSq_test <-chisq.test(contigency_table)\nglance(chiSq_test) %>% kable(digits = 3) %>% kable_styling(bootstrap_options = \"striped\", full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> parameter </th>\n   <th style=\"text-align:left;\"> method </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1.32 </td>\n   <td style=\"text-align:right;\"> 0.251 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> Pearson's Chi-squared test with Yates' continuity correction </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n#### **6.3.2. Compute relative risk**\n\nFinally, we can obtain our estimate of relative risk, by pushing the relevant data into the Epi package’s twoby2 function, using a 90% confidence interval, as requested.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntwoby2(analysisD_data$Smoking, analysisD_data$Obesity, conf.level = 0.90)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n2 by 2 table analysis: \n------------------------------------------------------ \nOutcome   : Obese \nComparing : Smoker vs. Non_Smoker \n\n           Obese Non_Obese    P(Obese) 90% conf. interval\nSmoker      1233      1522      0.4475    0.4320   0.4632\nNon_Smoker  1695      2219      0.4331    0.4201   0.4461\n\n                                   90% conf. interval\n             Relative Risk: 1.0335    0.9870   1.0821\n         Sample Odds Ratio: 1.0606    0.9767   1.1516\nConditional MLE Odds Ratio: 1.0605    0.9755   1.1531\n    Probability difference: 0.0145   -0.0058   0.0348\n\n             Exact P-value: 0.2491 \n        Asymptotic P-value: 0.2404 \n------------------------------------------------------\n```\n\n\n:::\n:::\n\n\n\n\nThe risk of being Obese for smokers relative to non-smokers is 1.0335 (90% CI:0.9870,1.0821), which implies that smokers are 3.35% more likely to be obese compared to non-smokers and since the 90% confidence intervals includes 1, this result is not statistically significant.\n\nThe Odds of being obese for smokers relative to non-smokers is 1.0606 (90% CI: 0.9767,1.1516). This implies that smokers have 6.06% higher odds of being obese compared to non-smokers. The confidence interval includes 1, indicating no statistical significance. The conditional maximum likelihood estimate odds ratio (MLE Odds Ratio) is 1.0605 (90%CI:0.9755,1.1531). This is consistent with the sample Odds Ratio, confirming that there is no statistically significant association.\n\nAdditionally, the absolute difference in probability of being obese between smokers and non-smokers is 0.0145(90%CI: -0.0058,0.0348), which highlights that smokers have a 1.68% higher probability of being obese compared to non-smokers. Further highlighting that there is no statistically significant association between smoking status and obesity as is also t indicated by exact p-value (p =0.2404) and asymptotic p-value (p=0.2491) being greater than 0.05 and the chi-square test (p=0.149).\n\n### 6.4. Conclusions.\n\nFrom the statistical analysis test conducted under this test analysis, we did not observe a statistically significant association between smoking status and obesity. However, this association may be influenced by other confounding factors such as lifestyle, physical activity, diet and other socio-economic factors.\n\n## 7. Analysis E\n\n### 7.1. Question\n\n#### 7.1.1. Research Question\n\nIs there a statistically significant relationship between race/ethnicity and education level in the NHANES population using a statistical analysis of a contingency table?\n\n#### 7.1.2. Problem Statement\n\nUnderstanding the relationship between race/ethnicity and education level is critical for addressing systemic disparities in access to educational opportunities. Education level is a key determinant of socioeconomic status, health outcomes, and overall quality of life. Similarly, race and ethnicity often intersect with structural barriers that shape access to education. Examining this relationship can provide insights into equity gaps and inform policy interventions.\n\n#### 7.1.3. Hypothesis\n\n##### 7.1.3.1. Null Hypothesis $({H_0})$:\n\nThere is no association between race/ethnicity and education level in the population represented by the 2017-March 2020 NHANES population data. The observed frequencies in the J x K table are consistent with what would be expected if the variables were independent.\n\n##### **7.1.3.2. Alternative Hypothesis** $({H_A})$:\n\nThere is an association between race/ethnicity and education level in the population. The observed frequencies in the J x K table deviate significantly from what would be expected under the assumptions of independence.\n\n### 7.2. Describing The Data\n\nThe data used for this analysis has been described in the codebook in section 3. However, this analysis unravels the association between two categorical variables of race/ethnicity and education level in the NHANES 2017-March 2020 population data set. Race/ethnicity is a categorical variable with 5 levels including Mexican, Hispanic, White, Black and American re-coded from the 6 levels originally present in the RIDRETH3 variable whereas Education level is also a categorical variable with 5 levels too, which have been re-coded to less_9th grade, 9_12th_grade, High_school, Some_college, and College_graduate, describing the 5 of the 6 levels of the original 'DMDEDUC2' variable in the 2017-March 2020 NHANES dataset.\n\n#### **7.2.1.** Data summary\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanalysisE_data <-readRDS('data/analysisE.rds')\nsummary(analysisE_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       Race                 Education   \n Mexican : 801   less_9th_grade  : 460  \n Hispanic: 733   9_12th_grade    : 702  \n White   :2323   High_school     :1611  \n Black   :1953   Some_College    :2182  \n Asian   : 859   College_graduate:1714  \n```\n\n\n:::\n:::\n\n\n\n\nFrom the summary statistics above we observed that there were more non-Hispanic white people than any other race in the dataset and the least represented group were other Hispanic. Notably, there were more people with a Some college degree followed by college graduates and there fewer people having a below 9th grade education.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanalysisE_data |>\ntabyl(Race,Education) |>\nadorn_totals(\"row\") |>\nadorn_percentages(\"row\") |>\nadorn_pct_formatting() |>\nadorn_ns(position = \"front\")%>% kable()%>%kable_styling(bootstrap_options = \"striped\", full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Race </th>\n   <th style=\"text-align:left;\"> less_9th_grade </th>\n   <th style=\"text-align:left;\"> 9_12th_grade </th>\n   <th style=\"text-align:left;\"> High_school </th>\n   <th style=\"text-align:left;\"> Some_College </th>\n   <th style=\"text-align:left;\"> College_graduate </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Mexican </td>\n   <td style=\"text-align:left;\"> 197 (24.6%) </td>\n   <td style=\"text-align:left;\"> 131 (16.4%) </td>\n   <td style=\"text-align:left;\"> 185 (23.1%) </td>\n   <td style=\"text-align:left;\"> 211 (26.3%) </td>\n   <td style=\"text-align:left;\"> 77  (9.6%) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Hispanic </td>\n   <td style=\"text-align:left;\"> 132 (18.0%) </td>\n   <td style=\"text-align:left;\"> 106 (14.5%) </td>\n   <td style=\"text-align:left;\"> 151 (20.6%) </td>\n   <td style=\"text-align:left;\"> 215 (29.3%) </td>\n   <td style=\"text-align:left;\"> 129 (17.6%) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> White </td>\n   <td style=\"text-align:left;\"> 37  (1.6%) </td>\n   <td style=\"text-align:left;\"> 182  (7.8%) </td>\n   <td style=\"text-align:left;\"> 596 (25.7%) </td>\n   <td style=\"text-align:left;\"> 871 (37.5%) </td>\n   <td style=\"text-align:left;\"> 637 (27.4%) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Black </td>\n   <td style=\"text-align:left;\"> 34  (1.7%) </td>\n   <td style=\"text-align:left;\"> 232 (11.9%) </td>\n   <td style=\"text-align:left;\"> 564 (28.9%) </td>\n   <td style=\"text-align:left;\"> 739 (37.8%) </td>\n   <td style=\"text-align:left;\"> 384 (19.7%) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Asian </td>\n   <td style=\"text-align:left;\"> 60  (7.0%) </td>\n   <td style=\"text-align:left;\"> 51  (5.9%) </td>\n   <td style=\"text-align:left;\"> 115 (13.4%) </td>\n   <td style=\"text-align:left;\"> 146 (17.0%) </td>\n   <td style=\"text-align:left;\"> 487 (56.7%) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Total </td>\n   <td style=\"text-align:left;\"> 460  (6.9%) </td>\n   <td style=\"text-align:left;\"> 702 (10.5%) </td>\n   <td style=\"text-align:left;\"> 1,611 (24.2%) </td>\n   <td style=\"text-align:left;\"> 2,182 (32.7%) </td>\n   <td style=\"text-align:left;\"> 1,714 (25.7%) </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\nIt was observed that Mexican American had the least education with at least 24.6% having 9th grade or below whereas Non-Hispanic Asians were the most educated with at least 56.7% of all Non-Hispanic Asian being a college graduate. This can be clearly visualized on the bar plot and the mosaic plots below.\n\n#### 7.2.2. Visualization\n\n##### 7.2.2.1 Bar plot\n\nI used the Bar graph to show the distribution of of education level frequency/count across the different races.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(analysisE_data, aes(x = Race, fill = Education))+\n  geom_bar(position = \"dodge\")+\n  labs(\n    title = \"Education level by Race/Ethnicity\",\n    x = \"Race\",\n    y = \"Count\",\n    fill = \"Education level\"\n  )+\n  theme_classic(base_size = 10) +\n  theme(legend.position = \"left\",\n        axis.title.y = element_text(face = \"bold\", size = 12),\n        axis.text = element_text(face =\"bold\", size = 12),\n        axis.title.x = element_text(face = \"bold\", size = 12),\n        plot.title = element_text(face = \"bold\", hjust = 0.5, size = 14),\n        plot.subtitle = element_text(hjust = 0.5,size = 12))\n```\n\n::: {.cell-output-display}\n![](Study1_files/figure-html/unnamed-chunk-28-1.png){width=768}\n:::\n:::\n\n\n\n\n##### 7.2.2.2 Mosaic plot\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a mosaic plot with `vcd::mosaic`\nmosaic(\n  ~ Race + Education, \n  data = as.data.frame(analysisE_data),\n  shade = TRUE,\n  labeling_args = list(\n    gp_labels = gpar(fontsize = 10),    # Increase cell label size\n    gp_varnames = gpar(fontsize = 10), # Increase axis labels size\n    gp_main = gpar(fontsize = 10)      # Increase title size\n  ),\n  main = \"Race vs Education Level\"\n)\n```\n\n::: {.cell-output-display}\n![](Study1_files/figure-html/unnamed-chunk-29-1.png){width=768}\n:::\n:::\n\n\n\n\n### 7.3. Main Analysis\n\nBasically, I applied the Chi-Square Test of independence to assess whether there is a significant association between race/ethnicity and education level in the population using the data as described\n\n#### **7.3.1. Chi-Square T test of Independence**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanalysisE_contigency_table <- analysisE_data %>% tabyl(Race, Education)\ncell_counts <- as.data.frame(analysisE_contigency_table)\nanalysisE_chisq <- chisq.test(analysisE_contigency_table)\nanalysisE_chisq %>% glance() %>% kable()%>%kable_styling(bootstrap_options = \"striped\", full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> parameter </th>\n   <th style=\"text-align:left;\"> method </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1363.866 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> Pearson's Chi-squared test </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nresiduals <- analysisE_chisq$stdres\nprint(residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     Race less_9th_grade 9_12th_grade High_school Some_College College_graduate\n  Mexican     21.0699799     5.729981  -0.7474826    -4.100507       -11.108046\n Hispanic     12.5818317     3.679362  -2.3842618    -2.071621        -5.320669\n    White    -12.4983175    -5.236461   2.0922118     6.077656         2.350614\n    Black    -10.6938790     2.316630   5.7976711     5.735575        -7.262552\n    Asian      0.1081499    -4.695567  -7.9001103   -10.522117        22.270682\n```\n\n\n:::\n:::\n\n\n\n\n#### 7.3.2. Convert residuals to a Heatmap\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresiduals_df <- as.data.frame(residuals)\ncolnames(residuals_df) <- c(\"Race\", \"Education\", \"Residual\")\n\nggplot(residuals_df, aes(x = Education, y = Race, fill = Residual)) +\n  geom_tile(color = \"white\") +\n  scale_fill_gradient2(low = \"blue\", high = \"red\", mid = \"white\", midpoint = 0) +\n  labs(title = \"Standardized Residuals Heatmap\", x = \"Education Level\", y = \"Race\") +\n   theme_classic(base_size = 10) +\n  theme(legend.position = \"left\",\n        axis.title.y = element_text(face = \"bold\", size = 12),\n        axis.text = element_text(face =\"bold\", size = 12),\n        axis.title.x = element_text(face = \"bold\", size = 12),\n        plot.title = element_text(face = \"bold\", hjust = 0.5, size = 14),\n        plot.subtitle = element_text(hjust = 0.5,size = 12))\n```\n\n::: {.cell-output-display}\n![](Study1_files/figure-html/unnamed-chunk-32-1.png){width=768}\n:::\n:::\n\n\n\n\nFrom the Chi-square residual heatmap, we observe that the Non-Hispanic population is overrepresented in attaining higher education as indicated by large positive residual (red), also we see that the Non-Hispanic Black population is overrepresented at lower education category while being underrepresented in the higher education category. Non-Hispanic Asians are under shown to be less represented at lower education levels suggesting they are less likely to fall into the lower education category whereas Mexican American and Other Hispanic groups vary, but with significant deviations in some education levels highlighting over-representation or underrepresentation.\n\n### 7.4. Conclusions\n\nThese findings suggest that there is a significant relationship between race/ethnicity and education levels, which supports for further exploration of the systemic or cultural factors driving these disparities.\n\n## 8. Session Information\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14)\nPlatform: aarch64-apple-darwin20\nRunning under: macOS Sonoma 14.5\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] grid      stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] lubridate_1.9.3     stringr_1.5.1       dplyr_1.1.4        \n [4] purrr_1.0.2         readr_2.1.5         tidyr_1.3.1        \n [7] tibble_3.2.1        tidyverse_2.0.0     epitools_0.5-10.1  \n[10] xfun_0.47           vcd_1.4-12          Epi_2.53           \n[13] broom.mixed_0.2.9.6 gridExtra_2.3       patchwork_1.2.0    \n[16] naniar_1.1.0        janitor_2.2.0       kableExtra_1.4.0   \n[19] ggpubr_0.6.0        ggplot2_3.5.1       boot_1.3-30        \n[22] Hmisc_5.1-3         forcats_1.0.0       nhanesA_1.2        \n\nloaded via a namespace (and not attached):\n [1] rlang_1.1.4         magrittr_2.0.3      snakecase_0.11.1   \n [4] furrr_0.3.1         compiler_4.4.1      mgcv_1.9-1         \n [7] systemfonts_1.1.0   vctrs_0.6.5         rvest_1.0.4        \n[10] pkgconfig_2.0.3     fastmap_1.2.0       backports_1.5.0    \n[13] labeling_0.4.3      utf8_1.2.4          rmarkdown_2.28     \n[16] tzdb_0.4.0          ragg_1.3.2          visdat_0.6.0       \n[19] jsonlite_1.8.9      highr_0.11          broom_1.0.6        \n[22] parallel_4.4.1      cluster_2.1.6       R6_2.5.1           \n[25] RColorBrewer_1.1-3  stringi_1.8.4       parallelly_1.38.0  \n[28] car_3.1-2           rpart_4.1.23        lmtest_0.9-40      \n[31] numDeriv_2016.8-1.1 Rcpp_1.0.13-1       knitr_1.48         \n[34] zoo_1.8-12          base64enc_0.1-3     Matrix_1.7-0       \n[37] splines_4.4.1       nnet_7.3-19         timechange_0.3.0   \n[40] tidyselect_1.2.1    rstudioapi_0.16.0   abind_1.4-5        \n[43] yaml_2.3.10         codetools_0.2-20    listenv_0.9.1      \n[46] lattice_0.22-6      plyr_1.8.9          withr_3.0.2        \n[49] evaluate_0.24.0     foreign_0.8-86      future_1.34.0      \n[52] survival_3.6-4      xml2_1.3.6          pillar_1.9.0       \n[55] carData_3.0-5       checkmate_2.3.2     generics_0.1.3     \n[58] hms_1.1.3           munsell_0.5.1       scales_1.3.0       \n[61] globals_0.16.3      etm_1.1.1           glue_1.8.0         \n[64] tools_4.4.1         data.table_1.16.0   ggsignif_0.6.4     \n[67] colorspace_2.1-1    nlme_3.1-164        htmlTable_2.4.3    \n[70] Formula_1.2-5       cli_3.6.3           textshaping_0.4.0  \n[73] fansi_1.0.6         viridisLite_0.4.2   svglite_2.1.3      \n[76] gtable_0.3.5        rstatix_0.7.2       digest_0.6.37      \n[79] htmlwidgets_1.6.4   farver_2.1.2        htmltools_0.5.8.1  \n[82] cmprsk_2.2-12       lifecycle_1.0.4     httr_1.4.7         \n[85] MASS_7.3-60.2      \n```\n\n\n:::\n:::\n",
    "supporting": [
      "Study1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}